{"version":3,"file":"733.primer_spec_plugin.min.js","mappings":"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","sources":["webpack:///./conditional_plugins/plugins/halloween.plugin.tsx"],"sourcesContent":["/** @jsx JSXDom.h */\nimport * as JSXDom from 'jsx-dom';\nexport default async function HalloweenPlugin(input) {\n    registerHalloweenSubthemeIfNeeded();\n    if (!input.settings_shown) {\n        replaceSettingsToggleWithHat();\n    }\n    else {\n        insertPumpkinsInThemePreview();\n    }\n    replaceSidebarToggleWithBook();\n    toggleFontIfNeeded(input.subtheme_name);\n    registerDblclickEasterEggIfNeeded(input.subtheme_name);\n    insertShyEmojiIfNeeded(input.subtheme_name);\n}\nfunction replaceSettingsToggleWithHat() {\n    const settingsIconClassList = document.querySelector('.primer-spec-settings-toggle i.fa-cog')?.classList;\n    if (settingsIconClassList) {\n        settingsIconClassList.remove('fa-cog');\n        settingsIconClassList.add('fa-hat-wizard');\n    }\n}\nfunction replaceSidebarToggleWithBook() {\n    const sidebarToggles = document.querySelectorAll('.primer-spec-hoverable i.fa-bars');\n    sidebarToggles.forEach((sidebarToggle) => {\n        sidebarToggle.classList.remove('fa-cog');\n        sidebarToggle.classList.add('fa-book-dead');\n    });\n}\n// Acknowledgement: The _design_ inspiration for this easter egg comes from a\n// similar easter egg in WhatsApp Web, where clicking on an expired \"view-once\"\n// media message shows an animated \"ðŸ¤«\" emoji.\nfunction createGhostEasterEggOnClick(event) {\n    let startX, startY;\n    if (event instanceof TouchEvent) {\n        startX = event.touches[0].clientX;\n        startY = event.touches[0].clientY;\n    }\n    else {\n        startX = event.clientX;\n        startY = event.clientY;\n    }\n    const ghostSize = 32;\n    startX -= ghostSize / 2;\n    startY -= ghostSize / 2;\n    const easterEggEmoji = (JSXDom.h(\"span\", { style: `position: fixed; top: ${startY}px; left: ${startX}px; z-index: 1000; font-size: ${ghostSize}px; transition: all 1s ease-out; user-select: none;` }, \"\\uD83D\\uDC7B\"));\n    // Animate the ghost right after it's rendered.\n    setTimeout(() => {\n        easterEggEmoji.style.transform = `translateY(-${Math.round(ghostSize * 1.5)}px)`;\n        easterEggEmoji.style.opacity = '0';\n    }, 0);\n    // And clean up after the animation is complete.\n    setTimeout(() => {\n        easterEggEmoji.remove();\n    }, 1500);\n    // Add the ghost to the page!\n    document.body.append(easterEggEmoji);\n}\nfunction registerDblclickEasterEggIfNeeded(subtheme_name) {\n    if (subtheme_name === 'spooky') {\n        document.body.addEventListener('dblclick', createGhostEasterEggOnClick, {\n            passive: true,\n        });\n        document.body.addEventListener('touchend', createGhostEasterEggOnClick, {\n            passive: true,\n        });\n    }\n    else {\n        document.body.removeEventListener('dblclick', createGhostEasterEggOnClick);\n        document.body.removeEventListener('touchend', createGhostEasterEggOnClick);\n    }\n}\nfunction insertPumpkinsInThemePreview() {\n    document\n        .querySelectorAll('svg.primer-spec-theme-preview-spooky-light, svg.primer-spec-theme-preview-spooky-dark')\n        .forEach((svg) => {\n        if (!svg.querySelector('.spooky-pumpkins')) {\n            svg.appendChild(JSXDom.h(\"text\", { class: \"spooky-pumpkins\", x: \"180\", y: \"130\", \"dominant-baseline\": \"middle\", \"text-anchor\": \"middle\", style: \"font-size: 72px;\" }, \"\\uD83C\\uDF83\\uD83C\\uDF83\\uD83C\\uDF83\"));\n        }\n    });\n}\nfunction registerHalloweenSubthemeIfNeeded() {\n    if (!window.PrimerSpec?.REGISTERED_SUBTHEMES?.['spooky']) {\n        // NOTE: This block of code will only ever be called ONCE per page session.\n        window.PrimerSpec?.registerNewSubtheme?.('spooky', 'ðŸŽƒ Spooky ðŸ‘»', constructHalloweenSubtheme());\n        // Force-update the theme. The page will have already loaded with the\n        // default theme, so we need to re-render with the spooky theme.\n        window.PrimerSpec?.updateTheme?.({}, false);\n    }\n}\nfunction constructHalloweenSubtheme() {\n    // NOTE: This method will only ever be called ONCE per page session.\n    // Hence, we can perform actions that modify the page state without\n    // having to worry about duplicated effects.\n    // Start by deep-copying the default theme's definition.\n    const defaultSubthemeDef = window.PrimerSpec.REGISTERED_SUBTHEMES['default'].theme_definition;\n    const halloweenSubthemeDef = JSON.parse(JSON.stringify(defaultSubthemeDef));\n    // Since we want to use a custom font, we need to inject it into the page.\n    document.head.appendChild(JSXDom.h(\"link\", { href: \"https://fonts.googleapis.com/css2?family=Creepster&family=Architects+Daughter&display=swap\", rel: \"stylesheet\" }));\n    // 'Spooky' is a dark-only theme. We'll first define the dark-mode colors,\n    // then we'll completely remove the light-mode colors.\n    // Finally, replace the light colors with the dark ones.\n    halloweenSubthemeDef['light'] = halloweenSubthemeDef['dark'];\n    return halloweenSubthemeDef;\n}\nfunction toggleFontIfNeeded(subtheme_name) {\n    const existingStyleTag = document.getElementById('primer-spec-halloween-font');\n    if (subtheme_name === 'spooky' && !existingStyleTag) {\n        document.body.appendChild(JSXDom.h(\"style\", { id: \"primer-spec-halloween-font\" },\n            \"body, .markdown-body, p \",\n            '{',\n            \"font-family: 'Architects Daughter'; \",\n            '}',\n            \"h1, h2, h3, h4, h5, h6 \",\n            '{',\n            \"font-family: 'Creepster' !important; \",\n            '}'));\n    }\n    else if (subtheme_name !== 'spooky' && existingStyleTag) {\n        existingStyleTag.remove();\n    }\n}\nfunction getRandomInt(min, max) {\n    min = Math.ceil(min);\n    max = Math.floor(max);\n    return Math.floor(Math.random() * (max - min)) + min;\n}\n/*** SHY EMOJI ***/\nconst emojiSpanId = 'primer-spec-shy-emoji';\nconst keyframesCssId = 'primer-spec-shy-emoji-keyframes';\nfunction insertShyEmojiImpl(subtheme_name) {\n    const initHeight = getRandomInt(10, 90);\n    const spookyEmojis = ['ðŸŽƒ', 'ðŸ‘»', 'ðŸ¤«', 'ðŸ§™', 'ðŸ§›', 'ðŸ§Ÿ', 'ðŸ‘º'];\n    const chosenEmoji = spookyEmojis[getRandomInt(0, spookyEmojis.length)];\n    const peakFromMargin = getRandomInt(0, 2) === 0 ? 'right' : 'left';\n    const shyEmojiKeyframes = (JSXDom.h(\"style\", { id: keyframesCssId },\n        '@keyframes peak-in-out {',\n        '  from {',\n        `    ${peakFromMargin}: -70px;`,\n        '  }',\n        '  20% {',\n        `    ${peakFromMargin}: -20px;`,\n        '  }',\n        '  80% {',\n        `    ${peakFromMargin}: -20px;`,\n        '  }',\n        '  to {',\n        `    ${peakFromMargin}: -70px;`,\n        '  }',\n        '}',\n        '@keyframes fly {',\n        '  25% {',\n        `    top: ${getRandomInt(10, 90)}vh;`,\n        '  }',\n        '  60% {',\n        `    top: ${getRandomInt(-1, 101)}vh;`,\n        '  }',\n        '  to {',\n        `    top: ${getRandomInt(-10, 110)}vh;`,\n        `    ${peakFromMargin}: 110vw;`,\n        '  }',\n        '}'));\n    document.body.append(shyEmojiKeyframes);\n    const shyEmoji = (\n    // eslint-disable-next-line jsx-a11y/no-static-element-interactions, jsx-a11y/click-events-have-key-events\n    JSXDom.h(\"span\", { id: emojiSpanId, style: `position: fixed; top: ${initHeight}%; ${peakFromMargin}: -70px; font-size: 60px; z-index: 1000; user-select: none; cursor: pointer;`, onClick: () => {\n            // If the emoji is still in the middle of peaking in, we want the\n            // animation to begin from wherever it currently is.\n            shyEmoji.style[peakFromMargin] = window.getComputedStyle(shyEmoji)[peakFromMargin];\n            shyEmoji.style.animationDelay = '0s';\n            shyEmoji.style.animationDuration = '3s';\n            shyEmoji.style.animationName = 'fly';\n        } }, chosenEmoji));\n    // Peak In and Out\n    shyEmoji.style.animationFillMode = 'forwards';\n    shyEmoji.style.animationDelay = '2s';\n    shyEmoji.style.animationDuration = '25s';\n    shyEmoji.style.animationTimingFunction = 'ease-in-out';\n    shyEmoji.style.animationName = 'peak-in-out';\n    // CLEANUP\n    shyEmoji.onanimationend = () => {\n        shyEmoji.remove();\n        shyEmojiKeyframes.remove();\n        // Rinse and repeat!\n        insertShyEmojiIfNeeded(subtheme_name);\n    };\n    document.body.append(shyEmoji);\n}\nfunction insertShyEmojiIfNeeded(subtheme_name) {\n    document.getElementById(emojiSpanId)?.remove();\n    document.getElementById(keyframesCssId)?.remove();\n    if (subtheme_name === 'spooky') {\n        insertShyEmojiImpl(subtheme_name);\n    }\n}\n"],"names":["async","HalloweenPlugin","input","window","PrimerSpec","REGISTERED_SUBTHEMES","registerNewSubtheme","defaultSubthemeDef","theme_definition","halloweenSubthemeDef","JSON","parse","stringify","document","head","appendChild","href","rel","constructHalloweenSubtheme","updateTheme","settings_shown","querySelectorAll","forEach","svg","querySelector","class","x","y","style","settingsIconClassList","classList","remove","add","replaceSettingsToggleWithHat","sidebarToggle","subtheme_name","existingStyleTag","getElementById","body","id","toggleFontIfNeeded","addEventListener","createGhostEasterEggOnClick","passive","removeEventListener","insertShyEmojiIfNeeded","event","startX","startY","TouchEvent","touches","clientX","clientY","ghostSize","easterEggEmoji","setTimeout","transform","Math","round","opacity","append","getRandomInt","min","max","ceil","floor","random","emojiSpanId","keyframesCssId","initHeight","spookyEmojis","chosenEmoji","length","peakFromMargin","shyEmojiKeyframes","shyEmoji","onClick","getComputedStyle","animationDelay","animationDuration","animationName","animationFillMode","animationTimingFunction","onanimationend","insertShyEmojiImpl"],"sourceRoot":""}